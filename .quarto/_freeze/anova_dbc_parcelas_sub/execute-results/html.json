{
  "hash": "d84a92db2feabed598a26408e1c58eb2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"anova_dbc_parcelas_sub\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# Pacotes necessários para o script completo\nlibrary(gsheet)       # Para importar dados do Google Sheets\nlibrary(Hmisc)        # Para stat_summary e manipulação de dados\nlibrary(ggplot2)      # Para visualizações\nlibrary(lme4)         # Para modelos lineares mistos (lmer)\nlibrary(DHARMa)       # Para diagnóstico de modelos mistos\nlibrary(emmeans)      # Para estimativas de médias marginais (EMMs)\nlibrary(multcomp)     # Para comparação múltipla com letras (cld)\nlibrary(car)          # Para Anova tipo II/III e utilidades adicionais\n```\n:::\n\n\n\n\n# **ANOVA - DBC**\n\nO **Delineamento em Blocos Casualizados (DBC)** é utilizado quando há uma variação ambiental conhecida que pode interferir nos resultados do experimento. Ele incorpora os **três princípios da experimentação**:\n\n-   **Repetição**;\n\n-   **Casualização**;\n\n-   **Controle local**.\n\nNeste caso, os tratamentos são aleatoriamente atribuídos dentro de cada bloco, o que permite controlar a variação não desejada (ex: diferenças de solo, luminosidade ou umidade no campo experimental).\n\n### Importação de dados\n\nA importação de dados é feita diretamente de uma planilha do Google Sheets usando a função `gsheet2tbl()`. Essa abordagem é útil porque permite manter os dados atualizados automaticamente.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gsheet)\ncampo <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=866852711#gid=866852711\")\n```\n:::\n\n\n\n\n### Transformação de dados\n\nAntes das análises, as variáveis categóricas são convertidas para o tipo **fator**, o que é essencial para que sejam tratadas corretamente nos modelos.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(Hmisc)\ncampo$TRAT <- factor(campo$TRAT)\ncampo$BLOCO <- factor(campo$BLOCO)\n```\n:::\n\n\n\n\n### Visualização exploratória\n\nGráfico de dispersão por tratamento, com média e intervalo de confiança em vermelho.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n  campo |>\n    ggplot(aes(TRAT, PROD)) +\n    geom_jitter(width = 0.1) +\n    stat_summary(\n    fun.data = \"mean_cl_boot\",\n    colour = \"red\", size = 0.3\n  )\n```\n\n::: {.cell-output-display}\n![](anova_dbc_parcelas_sub_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n### Análise de variância (ANOVA) com efeito de bloco\n\nÉ utilizado um modelo linear misto (`lmer`) com **TRAT** como efeito fixo e **BLOCO** como efeito aleatório.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lme4)\nm_campo <- lmer(PROD ~ TRAT + (1|BLOCO), data = campo)\nanova(m_campo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n     npar  Sum Sq Mean Sq F value\nTRAT    7 2993906  427701  2.9227\n```\n\n\n:::\n:::\n\n\n\n\n### Diagnóstico do modelo\n\nAvaliação dos resíduos simulados, fundamental para validar as suposições da ANOVA (normalidade e homocedasticidade).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DHARMa)\nplot(simulateResiduals(fittedModel = m_campo))\n```\n\n::: {.cell-output-display}\n![](anova_dbc_parcelas_sub_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\n### Estimativa de médias ajustadas e comparação múltipla\n\nAs médias ajustadas (EMMs) são estimadas para os tratamentos, seguidas de comparação de grupos usando letras diferentes (cld).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmeans_campo <- emmeans(m_campo, ~TRAT)\nmeans_campo\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT emmean  SE df lower.CL upper.CL\n 1      4219 191 24     3824     4614\n 2      4935 191 24     4540     5330\n 3      5110 191 24     4715     5505\n 4      5140 191 24     4745     5535\n 5      5122 191 24     4727     5517\n 6      5256 191 24     4861     5651\n 7      5128 191 24     4733     5522\n 8      5078 191 24     4683     5473\n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\nplot(means_campo)\n```\n\n::: {.cell-output-display}\n![](anova_dbc_parcelas_sub_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlibrary(multcomp)\ncld(means_campo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT emmean  SE df lower.CL upper.CL .group\n 1      4219 191 24     3824     4614  1    \n 2      4935 191 24     4540     5330  12   \n 8      5078 191 24     4683     5473  12   \n 3      5110 191 24     4715     5505  12   \n 5      5122 191 24     4727     5517  12   \n 7      5128 191 24     4733     5522   2   \n 4      5140 191 24     4745     5535   2   \n 6      5256 191 24     4861     5651   2   \n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 8 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\npwpp(means_campo)\n```\n\n::: {.cell-output-display}\n![](anova_dbc_parcelas_sub_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n:::\n\n\n\n\n# ANOVA - Parcelas Subdivididas\n\nO delineamento em parcelas subdivididas é usado quando se deseja estudar **dois fatores**, mas um deles exige maior parcela experimental. Neste caso, o **fator principal** é o híbrido e o **fator secundário** é o método. O uso de blocos e a subdivisão permitem maior controle experimental e economia de recursos.\n\n### Importação dos dados\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmilho <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1345524759#gid=1345524759\")\n```\n:::\n\n\n\n\n### Visualização exploratória\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmilho |> \n  ggplot(aes(hybrid, index, color = method)) +\n  geom_jitter(width = 0.1)+\n  coord_flip() +\n  facet_wrap(~method)\n```\n\n::: {.cell-output-display}\n![](anova_dbc_parcelas_sub_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n\n### Criação de fator de subparcela\n\nA interação entre `hybrid` e `block` representa as **subparcelas** dentro de cada parcela principal.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmilho$hybrid_block <- interaction(milho$hybrid,milho$block)\n#ou\n#milho |> \n # mutate(hybrid_bock = interaction(hybrid,block))\n```\n:::\n\n\n\n\n### Modelo linear misto para parcelas subdivididas\n\nA análise considera a interação entre híbrido e método como efeitos fixos, e os blocos aninhados como efeito aleatório.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lme4)\nm_milho <- lmer(index ~ hybrid*method + \n                  (1 | block:hybrid_block),\n                data = milho)\ncar::Anova(m_milho)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: index\n                Chisq Df Pr(>Chisq)   \nhybrid        11.4239  5    0.04359 * \nmethod         4.6964  1    0.03023 * \nhybrid:method 15.8062  5    0.00742 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n### Diagnóstico do modelo\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(simulateResiduals(m_milho))\n```\n\n::: {.cell-output-display}\n![](anova_dbc_parcelas_sub_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n\n### Médias ajustadas por híbrido dentro de cada método\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedia_milho <- emmeans(m_milho, ~ hybrid | method)\nmedia_milho\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nmethod = pin:\n hybrid   emmean   SE   df lower.CL upper.CL\n 30F53 HX   25.3 3.57 24.9     17.9     32.6\n 30F53 YH   24.6 3.57 24.9     17.3     31.9\n 30K64      20.6 3.57 24.9     13.2     27.9\n 30S31H     38.1 3.57 24.9     30.8     45.4\n 30S31YH    32.5 3.57 24.9     25.2     39.8\n BG7049H    19.4 3.57 24.9     12.1     26.8\n\nmethod = silk:\n hybrid   emmean   SE   df lower.CL upper.CL\n 30F53 HX   25.0 3.57 24.9     17.7     32.3\n 30F53 YH   26.2 3.57 24.9     18.9     33.6\n 30K64      21.5 3.57 24.9     14.2     28.8\n 30S31H     26.5 3.57 24.9     19.2     33.8\n 30S31YH    26.6 3.57 24.9     19.3     34.0\n BG7049H    19.2 3.57 24.9     11.8     26.5\n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \n```\n\n\n:::\n:::\n\n\n\n\n## Correlação entre Yield e Index\n\nNeste estudo, foi investigada a relação entre o índice `index` e a produtividade `yield` de plantas de milho. Para isso, utilizou-se um gráfico de dispersão com uma reta de regressão linear, gerado com a função `ggplot`. A dispersão dos pontos foi suavizada com `geom_jitter()` para evitar sobreposição, e a tendência entre as variáveis foi representada por uma linha ajustada via `geom_smooth(method = \"lm\")`, que aplica um modelo linear simples.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmilho |> ggplot(aes(index, yield)) + \n  geom_jitter() +\n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output-display}\n![](anova_dbc_parcelas_sub_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#correlação\ncor1 <- cor(milho$index, milho$yield)\ncor1*cor1*100\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 6.323713\n```\n\n\n:::\n\n```{.r .cell-code}\ncor.test(milho$index, milho$yield)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  milho$index and milho$yield\nt = -1.7622, df = 46, p-value = 0.08468\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.49988704  0.03517829\nsample estimates:\n       cor \n-0.2514699 \n```\n\n\n:::\n:::\n\n\n\n\nO gráfico resultante indica uma tendência negativa: à medida que os valores do índice aumentam, a produtividade tende a diminuir. Essa tendência é expressa pela inclinação negativa da reta azul, e a área sombreada ao redor dela representa o intervalo de confiança do modelo de regressão linear, evidenciando a incerteza associada à estimativa da média.\n\nPara quantificar essa relação, foi calculado o coeficiente de correlação de Pearson entre as duas variáveis. O valor obtido foi de aproximadamente -0,25, indicando uma correlação fraca e negativa entre o índice e a produtividade. Em outras palavras, embora exista uma tendência de redução da produtividade com o aumento do índice, essa relação não é forte. O coeficiente de determinação associado (R²) foi de apenas 6,32%, o que significa que apenas cerca de 6% da variação observada na produtividade pode ser explicada pela variação no índice. O restante se deve a outros fatores não considerados neste modelo.\n\nAdicionalmente, foi realizado o teste estatístico de correlação de Pearson. O valor de p obtido foi de 0,084, o que não é estatisticamente significativo ao nível de 5% (p \\> 0,05). Isso significa que não há evidências suficientes para rejeitar a hipótese nula de que não existe correlação entre as variáveis. O intervalo de confiança para a correlação (de -0,50 a 0,035) inclui o valor zero, reforçando essa conclusão.\n\nPortanto, embora o gráfico sugira uma leve tendência decrescente entre o índice e a produtividade, os resultados estatísticos indicam que essa associação é fraca e não significativa. É provável que outros fatores estejam influenciando a produtividade de maneira mais relevante do que o índice analisado.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(milho)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    hybrid              block         method              index      \n Length:48          Min.   :1.00   Length:48          Min.   :14.40  \n Class :character   1st Qu.:1.75   Class :character   1st Qu.:21.10  \n Mode  :character   Median :2.50   Mode  :character   Median :22.75  \n                    Mean   :2.50                      Mean   :25.46  \n                    3rd Qu.:3.25                      3rd Qu.:28.07  \n                    Max.   :4.00                      Max.   :48.90  \n                                                                     \n     yield           hybrid_block\n Min.   : 6621   30F53 HX.1: 2   \n 1st Qu.: 8058   30F53 YH.1: 2   \n Median : 9772   30K64.1   : 2   \n Mean   :10006   30S31H.1  : 2   \n 3rd Qu.:11816   30S31YH.1 : 2   \n Max.   :14280   BG7049H.1 : 2   \n                 (Other)   :36   \n```\n\n\n:::\n:::\n\n\n\n\n### Comparações múltiplas com letras (Teste de Tukey)\n\nApós a ANOVA e a obtenção das médias ajustadas com `emmeans`, é possível realizar um teste de comparações múltiplas para verificar **quais tratamentos diferem estatisticamente entre si**. Utiliza-se a função `cld()` do pacote `multcomp`, que adiciona **letras indicando grupos estatisticamente diferentes** com base em um teste como o de Tukey. Esse tipo de análise é comum em experimentos com múltiplos tratamentos, como nos delineamentos em parcelas subdivididas.\n\nMédias com letras **iguais** pertencem ao **mesmo grupo estatístico** (ou seja, **não diferem significativamente**). Médias com **letras diferentes** pertencem a **grupos distintos** e são **estatisticamente diferentes** ao nível de significância adotado (geralmente 5%).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncld_milho <- cld(media_milho, Letters = letters, adjust = \"tukey\")\ncld_milho\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nmethod = pin:\n hybrid   emmean   SE   df lower.CL upper.CL .group\n BG7049H    19.4 3.57 24.9     9.26     29.6  a    \n 30K64      20.6 3.57 24.9    10.36     30.7  a    \n 30F53 YH   24.6 3.57 24.9    14.41     34.8  ab   \n 30F53 HX   25.3 3.57 24.9    15.08     35.5  ab   \n 30S31YH    32.5 3.57 24.9    22.31     42.7  ab   \n 30S31H     38.1 3.57 24.9    27.91     48.3   b   \n\nmethod = silk:\n hybrid   emmean   SE   df lower.CL upper.CL .group\n BG7049H    19.2 3.57 24.9     8.98     29.4  a    \n 30K64      21.5 3.57 24.9    11.31     31.7  a    \n 30F53 HX   25.0 3.57 24.9    14.81     35.2  a    \n 30F53 YH   26.2 3.57 24.9    16.06     36.4  a    \n 30S31H     26.5 3.57 24.9    16.31     36.7  a    \n 30S31YH    26.6 3.57 24.9    16.46     36.8  a    \n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nConf-level adjustment: sidak method for 6 estimates \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n",
    "supporting": [
      "anova_dbc_parcelas_sub_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}